<!DOCTYPE HTML>
<html>
    <head>
        <title>เล่น m3u8 จากเว็บ</title>
        <meta charset="utf-8">
        <meta name="title" content="playid's M3U8 Proxy" />
        <meta name="description" content="Playground for testing playld's m3u8 proxy." />

        <meta property="og:type" content="website" />
        <meta property="og:title" content="PlayID's M3U8 Proxy" />
        <meta property="og:description" content="Playground for testing Hase0278's m3u8 proxy." />
        <meta property="og:image" content="" />

        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:title" content="PlayID's M3U8 Proxy"/>
        <meta property="twitter:description" content="Playground for testing Hase0278's m3u8 proxy." />
        <meta property="twitter:image" content="" />
        <style>
            video {
                width: 100%;
                height: 100%;
            }
        </style>
    </head>
    <body>
        <h1>การออกแบบสนามเด็กเล่นแย่มากแต่ก็ยังดี</h1>
        <p>โดยพื้นฐานแล้วให้ใส่ m3u8 สำหรับ url และใส่ส่วนหัวที่เป็นสตริงลงในส่วนหัว ใช่แล้ว เป็นเช่นนั้นเอง</p>
        <label for="url">URL</label>
        <input type="text" id="url" value="https://www.livedoomovies.com/02_sport1_720p/playlist.m3u8" />
        <label for="headers">Headers</label>
        <textarea id="headers">{"referer": "https://www.88-hd.com/"}</textarea>
        <button onclick="test()">Test</button>
        <video id="hls" controls></video>
        <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
        <script>
            function test() {
                const url = document.getElementById('url').value;
                let headers = document.getElementById('headers').value;

                try {
                    headers = JSON.parse(headers);
                } catch (e) {
                    headers = {};
                    alert("Invalid headers. Set headers to {}.");
                }

                console.log("Using URL " + url);
                console.log("Using headers " + JSON.stringify(headers));

                if (Hls.isSupported()) {
                    var video = document.getElementById('hls');
                    var hls = new Hls();
                    hls.loadSource(`/m3u8-proxy?url=${encodeURIComponent(url)}&headers=${encodeURIComponent(JSON.stringify(headers))}`);
                    hls.attachMedia(video);
                    hls.on(Hls.Events.MANIFEST_PARSED, function() {
                        console.log(`/m3u8-proxy?url=${encodeURIComponent(url)}&headers=${encodeURIComponent(JSON.stringify(headers))}`)
                    });
                }
            }
        </script>
    </body>
</html>
